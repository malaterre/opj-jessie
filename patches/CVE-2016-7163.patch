Backport of c16bc057ba3f125051c9966cf1f5b68a05681de4 and
ef01f18dfc6780b776d0674ed3e7415c6ef54d24

--- openjpeg2-2.1.0.orig/src/lib/openjp2/pi.c
+++ openjpeg2-2.1.0/src/lib/openjp2/pi.c
@@ -1233,7 +1233,13 @@ opj_pi_iterator_t *opj_pi_create_decode(
 	l_current_pi = l_pi;
 
 	/* memory allocation for include */
-	l_current_pi->include = (OPJ_INT16*) opj_calloc((l_tcp->numlayers +1) * l_step_l, sizeof(OPJ_INT16));
+	/* prevent an integer overflow issue */
+	l_current_pi->include = 00;
+	if (l_step_l <= (SIZE_MAX / (l_tcp->numlayers + 1U)))
+	{
+		l_current_pi->include = (OPJ_INT16*) opj_calloc((size_t)(l_tcp->numlayers + 1U) * l_step_l, sizeof(OPJ_INT16));
+	}
+
 	if
 		(!l_current_pi->include)
 	{
