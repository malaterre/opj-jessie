Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 openjpeg2 (2.1.0-2+deb8u3) jessie-security; urgency=medium
 .
   * CVE-2016-9118: c22cbd8bdf8ff2ae372f94391a4be2d322b36b41.patch
   * CVE-2016-5152: 3fbe71369019df0b47c7a2be4fab8c05768f2f32.patch
   * CVE-2016-1628: 11445eddad7e7fa5b273d1c83c91011c44e5d586.patch
   * CVE-2016-10504: not needed
   * CVE-2017-14039: CVE-2017-14039.patch
   * CVE-2017-14040: 2cd30c2b06ce332dede81cccad8b334cde997281.patch
   * CVE-2017-14041: e5285319229a5d77bf316bb0d3a6cbd3cb8666d9.patch
   * CVE-2017-14151: not needed
   * CVE-2017-14152: dcac91b8c72f743bda7dbfa9032356bc8110098a.patch
Author: Mathieu Malaterre <malat@debian.org>

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: https://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: 2017-10-23

--- openjpeg2-2.1.0.orig/src/lib/openjp2/tcd.c
+++ openjpeg2-2.1.0/src/lib/openjp2/tcd.c
@@ -668,8 +668,10 @@ OPJ_BOOL FUNCTION (     opj_tcd_t *p_tcd
         /* 4 borders of the tile rescale on the image if necessary */                                                                                                                                             \
         l_tile->x0 = opj_int_max((OPJ_INT32)(l_cp->tx0 + p * l_cp->tdx), (OPJ_INT32)l_image->x0);                                                                                                                                             \
         l_tile->y0 = opj_int_max((OPJ_INT32)(l_cp->ty0 + q * l_cp->tdy), (OPJ_INT32)l_image->y0);                                                                                                                                             \
+if (l_tile->x0 < 0 || l_tile->x1 < 0) return OPJ_FALSE; \
         l_tile->x1 = opj_int_min((OPJ_INT32)(l_cp->tx0 + (p + 1) * l_cp->tdx), (OPJ_INT32)l_image->x1);                                                                                                                                       \
         l_tile->y1 = opj_int_min((OPJ_INT32)(l_cp->ty0 + (q + 1) * l_cp->tdy), (OPJ_INT32)l_image->y1);                                                                                                                                       \
+if (l_tile->y0 < 0 || l_tile->y1 < 0) return OPJ_FALSE; \
         /* testcase 1888.pdf.asan.35.988 */ \
         if (l_tccp->numresolutions == 0) { \
             fprintf(stderr, "tiles require at least one resolution\n"); \
